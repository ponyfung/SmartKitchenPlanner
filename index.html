<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AIÂªöÂ∏´ by Êó•Êú¨ÂØ¶Q</title>
    
    <!-- Ë®≠ÂÆö App Icon -->
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Libraries for Export -->
    <!-- PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- Excel Generation (SheetJS) -->
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <!-- App Styles -->
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        
        /* Print/Export Styles */
        .page-break { page-break-after: always; break-after: page; }
    </style>
</head>
<body class="bg-[#F8F9FA]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Helper: Image Compression ---
        const compressImage = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const MAX_WIDTH = 1024; 
                        const MAX_HEIGHT = 1024;
                        let width = img.width;
                        let height = img.height;

                        if (width > height) {
                            if (width > MAX_WIDTH) {
                                height *= MAX_WIDTH / width;
                                width = MAX_WIDTH;
                            }
                        } else {
                            if (height > MAX_HEIGHT) {
                                width *= MAX_HEIGHT / height;
                                height = MAX_HEIGHT;
                            }
                        }

                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);
                        resolve(dataUrl);
                    };
                    img.onerror = (error) => reject(error);
                };
                reader.onerror = (error) => reject(error);
            });
        };

        // --- Helper: Date Formatting ---
        const getFormatDate = (start, offset, lang) => {
            const date = new Date(start);
            date.setDate(date.getDate() + offset);
            return date.toLocaleDateString(lang === 'zh' ? 'zh-HK' : 'en-US', { 
              month: 'numeric', 
              day: 'numeric', 
              weekday: 'short' 
            });
        };

        // --- Export Functions ---

        // 1. Excel Export (One sheet per day)
        const exportExcel = (data, startDate, lang) => {
            const wb = XLSX.utils.book_new();
            
            data.schedule.forEach((dayPlan, index) => {
                const dateStr = getFormatDate(startDate, index, lang);
                const sheetName = `Day ${dayPlan.day}`;
                
                // Define headers and data structure
                const ws_data = [
                    [`${dateStr} - Day ${dayPlan.day}`],
                    ["È§êÈªû (Meal)", "ËèúËâ≤ (Dish)", "ÊùêÊñô (Ingredients)", "Ë™øÂë≥ (Seasoning)", "ÂÅöÊ≥ï (Steps)"],
                ];

                ['breakfast', 'lunch', 'dinner'].forEach(type => {
                    const meal = dayPlan.meals[type];
                    if (meal && meal.name) {
                        ws_data.push([
                            type.toUpperCase(),
                            meal.name,
                            meal.ingredients,
                            meal.seasoning,
                            meal.steps
                        ]);
                    } else {
                         ws_data.push([type.toUpperCase(), "N/A", "", "", ""]);
                    }
                });

                const ws = XLSX.utils.aoa_to_sheet(ws_data);
                
                // Styling width (basic)
                ws['!cols'] = [{wch:15}, {wch:20}, {wch:30}, {wch:20}, {wch:50}];

                XLSX.utils.book_append_sheet(wb, ws, sheetName);
            });

            // Summary Sheet
            const summary_data = [
                ["È°ûÂà•", "È†ÖÁõÆ"],
                ["ÈúÄÁî®È£üÊùê", ...data.summary.ingredients_list],
                ["", ""],
                ["ÈúÄÁî®Ë™øÂë≥", ...data.summary.seasonings_list]
            ];
            // Since data structures are arrays, let's map them properly
            const formattedSummary = [
                ["Á∏ΩË¶Ω Summary"],
                ["È°ûÂûã Type", "È†ÖÁõÆ Item"]
            ];
            data.summary.ingredients_list.forEach(item => formattedSummary.push(["È£üÊùê", item]));
            data.summary.seasonings_list.forEach(item => formattedSummary.push(["Ë™øÂë≥", item]));
            
            const ws_summary = XLSX.utils.aoa_to_sheet(formattedSummary);
            XLSX.utils.book_append_sheet(wb, ws_summary, "Summary");

            XLSX.writeFile(wb, "SmartKitchenPlan.xlsx");
        };

        // 2. Word Export (HTML Blob with page breaks)
        const exportWord = (data, startDate, lang) => {
            let htmlContent = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset='utf-8'><title>Meal Plan</title>
                <style>
                    body { font-family: 'Microsoft JhengHei', sans-serif; }
                    .day-container { page-break-after: always; }
                    h1 { color: #F97316; }
                    h2 { background-color: #eee; padding: 5px; }
                    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                    td, th { border: 1px solid #ccc; padding: 8px; vertical-align: top; }
                    th { background-color: #f0f0f0; text-align: left; }
                </style>
                </head><body>
            `;

            data.schedule.forEach((dayPlan, index) => {
                const dateStr = getFormatDate(startDate, index, lang);
                htmlContent += `
                    <div class="day-container">
                        <h1>${dateStr} (Day ${dayPlan.day})</h1>
                        <table>
                            <tr>
                                <th width="15%">È§êÈªû</th>
                                <th width="20%">ËèúËâ≤</th>
                                <th width="65%">Ë©≥ÊÉÖ</th>
                            </tr>
                `;

                ['breakfast', 'lunch', 'dinner'].forEach(type => {
                    const meal = dayPlan.meals[type];
                    if(meal && meal.name) {
                        htmlContent += `
                            <tr>
                                <td><b>${type.toUpperCase()}</b></td>
                                <td><b>${meal.name}</b></td>
                                <td>
                                    <p><b>ÊùêÊñô:</b> ${meal.ingredients}</p>
                                    <p><b>Ë™øÂë≥:</b> ${meal.seasoning}</p>
                                    <p><b>ÂÅöÊ≥ï:</b><br/>${meal.steps.replace(/\n/g, '<br/>')}</p>
                                </td>
                            </tr>
                        `;
                    }
                });

                htmlContent += `</table></div>`;
            });

            // Summary at the end
            htmlContent += `
                <div>
                    <h1>Êé°Ë≥ºÂèäË™øÂë≥Á∏ΩË¶Ω</h1>
                    <h2>ÈúÄÁî®È£üÊùê</h2>
                    <ul>${data.summary.ingredients_list.map(i => `<li>${i}</li>`).join('')}</ul>
                    <h2>ÈúÄÁî®Ë™øÂë≥</h2>
                    <ul>${data.summary.seasonings_list.map(i => `<li>${i}</li>`).join('')}</ul>
                </div>
                </body></html>
            `;

            const blob = new Blob([htmlContent], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'SmartKitchenPlan.doc';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };

        // 3. PDF Export
        const exportPDF = () => {
            const element = document.getElementById('export-container');
            const opt = {
                margin: 10,
                filename: 'SmartKitchenPlan.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };
            // Temporarily show the export container which is usually hidden or styled differently
            // Actually, we can just print the current Result view but we need to ensure page breaks.
            // A better way is to construct a hidden div specifically for PDF generation to ensure perfect "One Day One Page"
            
            // For simplicity in this React structure, we will target a specific div that we will add class 'pdf-export-mode' to temporarily
            html2pdf().set(opt).from(element).save();
        };


        // --- Icon Components ---
        const IconBase = ({ children, size = 24, className = "", ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );

        const Icons = {
            Camera: (p) => <IconBase {...p}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></IconBase>,
            Settings: (p) => <IconBase {...p}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></IconBase>,
            ChefHat: (p) => <IconBase {...p}><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"/><line x1="6" y1="17" x2="18" y2="17"/></IconBase>,
            Save: (p) => <IconBase {...p}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconBase>,
            Trash2: (p) => <IconBase {...p}><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></IconBase>,
            Utensils: (p) => <IconBase {...p}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></IconBase>,
            Clock: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconBase>,
            ChevronDown: (p) => <IconBase {...p}><polyline points="6 9 12 15 18 9"/></IconBase>,
            ChevronUp: (p) => <IconBase {...p}><polyline points="18 15 12 9 6 15"/></IconBase>,
            AlertCircle: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></IconBase>,
            Loader2: (p) => <IconBase {...p}><path d="M21 12a9 9 0 1 1-6.21-8.85"/></IconBase>,
            ArrowRight: (p) => <IconBase {...p}><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></IconBase>,
            BookOpen: (p) => <IconBase {...p}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>,
            ImageIcon: (p) => <IconBase {...p}><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></IconBase>,
            Plus: (p) => <IconBase {...p}><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></IconBase>,
            X: (p) => <IconBase {...p}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></IconBase>,
            List: (p) => <IconBase {...p}><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></IconBase>,
            Globe: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></IconBase>,
            Sun: (p) => <IconBase {...p}><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></IconBase>,
            Coffee: (p) => <IconBase {...p}><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></IconBase>,
            Moon: (p) => <IconBase {...p}><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></IconBase>,
            AtSign: (p) => <IconBase {...p}><circle cx="12" cy="12" r="4"/><path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94"/></IconBase>,
            ExternalLink: (p) => <IconBase {...p}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></IconBase>,
            FileText: (p) => <IconBase {...p}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></IconBase>,
            FileSpreadsheet: (p) => <IconBase {...p}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/></IconBase>,
            Download: (p) => <IconBase {...p}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></IconBase>
        };

        const TRANSLATIONS = {
          zh: {
            title: "AIÂªöÂ∏´ by Êó•Êú¨ÂØ¶Q",
            threadsLinkText: "Êí≥Âë¢Â∫¶ Follow ÊàëÂòÖ Threads",
            uploadPhotos: "‰∏äËºâÁõ∏Áâá",
            ingredientsReceipt: "È£üÊùê / Êî∂Êìö",
            seasoning: "Ë™øÂë≥Êñô",
            onePhoto: "ÂΩ±‰∏ÄÂºµ",
            album: "Áõ∏Á∞øÂ§öÂºµ",
            clear: "Ê∏ÖÁ©∫",
            settings: "Ë®≠ÂÆö",
            daysLabel: "Ë®àÂäÉÊó•Êï∏",
            mealsLabel: "È§êÊï∏ÂæÆË™ø",
            cuisineStyle: "Âè£Âë≥È¢®Ê†º (ÂèØÂ§öÈÅ∏)",
            generate: "ÁîüÊàêÈ£üË≠ú Grid",
            analyzing: "Ê≠£Âú®ÂàÜÊûêÈ£üÊùê...",
            planTitle: "È£üË≠úË¶èÂäÉ",
            modify: "‰øÆÊîπ",
            regenerate: "ÈáçÊï¥",
            summaryTitle: "È£üÊùêÂèäË™øÂë≥ÊñôÁ∏ΩË¶Ω",
            needIngredients: "ÈúÄÁî®È£üÊùê",
            needSeasonings: "ÈúÄÁî®Ë™øÂë≥",
            steps: "ÂÅöÊ≥ïÊ≠•È©ü",
            ingredients: "ÊùêÊñô",
            flavor: "Ë™øÂë≥",
            apiKeyPlaceholder: "Ë´ãËº∏ÂÖ• Gemini API Key...",
            save: "ÂÑ≤Â≠ò",
            cancel: "ÂèñÊ∂à",
            apiKeyNote: "Key Âè™ÊúÉÂÑ≤Â≠òÊñºÊú¨Âú∞Ë£ùÁΩÆ„ÄÇ",
            errorKey: "Ë´ãÂÖàÂñ∫Âè≥‰∏äËßíË®≠ÂÆöËº∏ÂÖ• Gemini API Key",
            errorImg: "Ë´ãÂÖàÂΩ±ÊàñËÄÖ‰∏äËºâÈ£üÊùê/Êî∂ÊìöÁõ∏Áâá",
            breakfast: "Êó©È§ê",
            lunch: "ÂçàÈ§ê",
            dinner: "ÊôöÈ§ê",
            startDate: "ÈñãÂßãÊó•Êúü",
            day: "Á¨¨ {n} Êó•",
            exportTitle: "ÂåØÂá∫È£üË≠ú",
            exportPDF: "PDF (‰∏ÄÊó•‰∏ÄÁâà)",
            exportWord: "Word (‰∏ÄÊó•‰∏ÄÁâà)",
            exportExcel: "Excel (ÂàÜSheet)",
            styles: {
              hk: "Ê∏ØÂºèÂÆ∂Â∏∏",
              thai: "Ê≥∞ÂºèÈ¢®Âë≥",
              jp: "Êó•ÂºèÊñôÁêÜ",
              western: "Ë•øÂºè/ÊÑèÂºè",
              spicy: "Â∑ùËæ£È¢®Âë≥",
              healthy: "ÂÅ•Â∫∑‰ΩéËÑÇ",
              korean: "ÈüìÂºè",
              fusion: "ÂâµÊÑèËûçÂêà"
            }
          },
          en: {
            title: "AI Chef by Japan Real Q",
            threadsLinkText: "Follow me on Threads",
            uploadPhotos: "Upload Photos",
            ingredientsReceipt: "Ingredients / Receipt",
            seasoning: "Seasonings",
            onePhoto: "Camera",
            album: "Gallery",
            clear: "Clear",
            settings: "Settings",
            daysLabel: "Total Days",
            mealsLabel: "Meal Counts",
            cuisineStyle: "Cuisine Style (Multi-select)",
            generate: "Generate Plan",
            analyzing: "Analyzing...",
            planTitle: "Meal Plan",
            modify: "Edit",
            regenerate: "Regenerate",
            summaryTitle: "Shopping & Pantry List",
            needIngredients: "Ingredients Needed",
            needSeasonings: "Seasonings Needed",
            steps: "Instructions",
            ingredients: "Items",
            flavor: "Seasoning",
            apiKeyPlaceholder: "Enter Gemini API Key...",
            save: "Save",
            cancel: "Cancel",
            apiKeyNote: "Key is stored locally on your device.",
            errorKey: "Please enter Gemini API Key in Settings first",
            errorImg: "Please upload ingredient/receipt photos first",
            breakfast: "Breakfast",
            lunch: "Lunch",
            dinner: "Dinner",
            startDate: "Start Date",
            day: "Day {n}",
            exportTitle: "Export Plan",
            exportPDF: "PDF (1 Day/Page)",
            exportWord: "Word (1 Day/Page)",
            exportExcel: "Excel (Sheets)",
            styles: {
              hk: "HK Style",
              thai: "Thai",
              jp: "Japanese",
              western: "Western",
              spicy: "Sichuan Spicy",
              healthy: "Healthy/Low Fat",
              korean: "Korean",
              fusion: "Fusion"
            }
          }
        };

        const App = () => {
          const [lang, setLang] = useState('zh');
          const t = TRANSLATIONS[lang]; 
          
          const [apiKey, setApiKey] = useState('');
          const [showSettings, setShowSettings] = useState(false);
          
          const [ingredientImgs, setIngredientImgs] = useState([]); 
          const [seasoningImgs, setSeasoningImgs] = useState([]); 
          
          const [days, setDays] = useState(3);
          const [meals, setMeals] = useState({ breakfast: 3, lunch: 3, dinner: 3 }); 
          const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]); 
          const [selectedCuisines, setSelectedCuisines] = useState(['hk']); 
          
          const [loading, setLoading] = useState(false);
          const [resultData, setResultData] = useState(null);
          const [error, setError] = useState(null);
          const [activeTab, setActiveTab] = useState('input'); 

          useEffect(() => {
            const storedKey = localStorage.getItem('gemini_api_key');
            if (storedKey) setApiKey(storedKey);

            const storedSeasonings = localStorage.getItem('seasoning_imgs');
            if (storedSeasonings) {
                try {
                    setSeasoningImgs(JSON.parse(storedSeasonings));
                } catch (e) { console.error(e); }
            }
          }, []);

          useEffect(() => {
            setMeals({
              breakfast: days,
              lunch: days,
              dinner: days
            });
          }, [days]);

          const toggleLanguage = () => {
            setLang(prev => prev === 'zh' ? 'en' : 'zh');
          };

          const toggleCuisine = (styleKey) => {
            setSelectedCuisines(prev => {
              if (prev.includes(styleKey)) {
                if (prev.length === 1) return prev;
                return prev.filter(k => k !== styleKey);
              } else {
                return [...prev, styleKey];
              }
            });
          };

          const saveApiKey = (key) => {
            setApiKey(key);
            localStorage.setItem('gemini_api_key', key);
            setShowSettings(false);
          };

          const handleImageUpload = async (e, type) => {
            const files = Array.from(e.target.files);
            if (files.length === 0) return;
            const MAX_IMAGES = 5;

            const compressedImages = [];
            for (const file of files) {
                try {
                    const compressedBase64 = await compressImage(file);
                    compressedImages.push(compressedBase64);
                } catch (err) {
                    console.error("Image compression failed", err);
                }
            }

            if (type === 'ingredient') {
              setIngredientImgs(prev => [...prev, ...compressedImages].slice(0, MAX_IMAGES));
            } else {
              setSeasoningImgs(prev => {
                 const newImgs = [...prev, ...compressedImages].slice(0, MAX_IMAGES);
                 try {
                     localStorage.setItem('seasoning_imgs', JSON.stringify(newImgs));
                 } catch (e) {
                     console.error("Storage full", e);
                 }
                 return newImgs;
              });
            }
          };

          const removeImage = (type, index) => {
              if (type === 'ingredient') {
                  setIngredientImgs(prev => prev.filter((_, i) => i !== index));
              } else {
                  setSeasoningImgs(prev => {
                      const newImgs = prev.filter((_, i) => i !== index);
                      localStorage.setItem('seasoning_imgs', JSON.stringify(newImgs));
                      return newImgs;
                  });
              }
          };

          const clearSeasonings = () => {
            setSeasoningImgs([]);
            localStorage.removeItem('seasoning_imgs');
          };

          const generateRecipes = async () => {
            if (!apiKey) {
              setError(t.errorKey);
              setShowSettings(true);
              return;
            }
            if (ingredientImgs.length === 0) {
              setError(t.errorImg);
              return;
            }

            setLoading(true);
            setError(null);
            setResultData(null);

            const styleNames = selectedCuisines.map(key => t.styles[key]).join(', ');
            const languageInstruction = lang === 'zh' ? 'Áî®ÁπÅÈ´î‰∏≠Êñá(Âª£Êù±Ë©±Âè£Ë™ûÈ¢®Ê†º)' : 'in English';

            try {
              const prompt = `
                You are a professional chef. Plan meals based on the provided images (ingredients/receipts first, then pantry/seasonings).
                
                „ÄêConstraints„Äë:
                - Total Span: ${days} days
                - Actual Meal Counts Needed: 
                  - Breakfast: ${meals.breakfast} portions
                  - Lunch: ${meals.lunch} portions
                  - Dinner: ${meals.dinner} portions
                - Cuisine Styles: ${styleNames}
                - **Language**: Output strictly ${languageInstruction}.
                
                „ÄêOutput Format„Äë:
                **Strictly JSON only**. No Markdown blocks.
                
                Structure:
                {
                  "summary": {
                    "ingredients_list": ["Item 1", "Item 2"],
                    "seasonings_list": ["Item 1", "Item 2"]
                  },
                  "schedule": [
                    {
                      "day": 1,
                      "meals": {
                        "breakfast": { "name": "...", "ingredients": "...", "seasoning": "...", "steps": "..." },
                        "lunch": { "name": "...", "ingredients": "...", "seasoning": "...", "steps": "..." },
                        "dinner": { "name": "...", "ingredients": "...", "seasoning": "...", "steps": "..." }
                      }
                    }
                  ]
                }
                
                Note: If a specific meal type count is 0 or exhausted for a day, leave that meal slot empty/null in the JSON.
                Make sure quantities are precise (grams, tbsp, tsp).
              `;

              const imageParts = [...ingredientImgs, ...seasoningImgs].map(img => ({
                  inlineData: { mimeType: "image/jpeg", data: img.split(',')[1] }
              }));

              const contents = [{
                  role: "user",
                  parts: [{ text: prompt }, ...imageParts]
              }];

              const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents, generationConfig: { responseMimeType: "application/json" } })
              });

              const data = await response.json();
              if (data.error) throw new Error(data.error.message);

              let textResponse = data.candidates[0].content.parts[0].text;
              textResponse = textResponse.replace(/```json/g, '').replace(/```/g, '').trim();
              
              const parsedData = JSON.parse(textResponse);
              setResultData(parsedData);
              setActiveTab('result');

            } catch (err) {
              console.error(err);
              setError(err.message || "Error generating recipes");
            } finally {
              setLoading(false);
            }
          };

          // --- Components ---
          const PhotoUploader = ({ title, images, onUpload, onRemove, type }) => (
            <div className="bg-white p-5 rounded-3xl border border-gray-100 shadow-sm">
                <div className="flex justify-between items-center mb-4">
                    <h3 className="font-bold text-gray-700 flex items-center gap-2">
                        {type === 'ingredient' ? <Icons.Utensils size={18}/> : <Icons.Save size={18}/>}
                        {title}
                        <span className="text-xs font-normal text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full">{images.length}</span>
                    </h3>
                    {images.length > 0 && type === 'seasoning' && (
                        <button onClick={clearSeasonings} className="text-red-400 text-xs flex items-center gap-1 hover:text-red-600">
                            <Icons.Trash2 size={12}/> {t.clear}
                        </button>
                    )}
                </div>
                <div className="flex gap-3 mb-4">
                    <label className="flex-1 cursor-pointer group">
                        <input type="file" accept="image/*" capture="environment" onChange={(e) => onUpload(e, type)} className="hidden" />
                        <div className="h-24 rounded-2xl bg-orange-50 border-2 border-dashed border-orange-200 flex flex-col items-center justify-center gap-2 text-orange-600 group-active:scale-95 transition-all">
                            <Icons.Camera size={24} />
                            <span className="text-xs font-bold">{t.onePhoto}</span>
                        </div>
                    </label>
                    <label className="flex-1 cursor-pointer group">
                        <input type="file" accept="image/*" multiple onChange={(e) => onUpload(e, type)} className="hidden" />
                        <div className="h-24 rounded-2xl bg-blue-50 border-2 border-dashed border-blue-200 flex flex-col items-center justify-center gap-2 text-blue-600 group-active:scale-95 transition-all">
                            <Icons.ImageIcon size={24} />
                            <span className="text-xs font-bold">{t.album}</span>
                        </div>
                    </label>
                </div>
                {images.length > 0 && (
                    <div className="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
                        {images.map((img, idx) => (
                            <div key={idx} className="relative flex-shrink-0 w-20 h-20 rounded-xl overflow-hidden border border-gray-200 shadow-sm">
                                <img src={img} alt="preview" className="w-full h-full object-cover" />
                                <button onClick={() => onRemove(type, idx)} className="absolute top-1 right-1 bg-black/50 text-white rounded-full p-1 hover:bg-red-500 transition-colors">
                                    <Icons.X size={12} />
                                </button>
                            </div>
                        ))}
                    </div>
                )}
            </div>
          );

          const MealCard = ({ mealType, data }) => {
            if (!data || !data.name) return (
              <div className="bg-gray-50 p-4 rounded-xl border border-gray-100 border-dashed h-full flex flex-col items-center justify-center opacity-50">
                 <div className="text-gray-300 mb-1">
                     {mealType === 'breakfast' && <Icons.Sun size={24}/>}
                     {mealType === 'lunch' && <Icons.Coffee size={24}/>}
                     {mealType === 'dinner' && <Icons.Moon size={24}/>}
                 </div>
                 <span className="text-xs text-gray-400">No Meal</span>
              </div>
            );

            return (
              <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow h-full flex flex-col">
                  <div className="flex items-center gap-2 mb-2 pb-2 border-b border-gray-50">
                      <span className="text-lg">
                          {mealType === 'breakfast' && 'üåû'}
                          {mealType === 'lunch' && 'üç±'}
                          {mealType === 'dinner' && 'üåô'}
                      </span>
                      <span className="text-xs font-bold text-gray-500 uppercase tracking-wide">
                          {t[mealType]}
                      </span>
                  </div>
                  <h4 className="font-bold text-gray-800 text-sm mb-2 line-clamp-2 min-h-[2.5rem]">{data.name}</h4>
                  <div className="flex-1 space-y-2">
                      <div className="bg-orange-50 p-2 rounded-lg">
                          <p className="text-[10px] text-gray-400 font-bold mb-0.5">{t.ingredients}</p>
                          <p className="text-xs text-gray-700 leading-snug">{data.ingredients}</p>
                      </div>
                      <div className="bg-green-50 p-2 rounded-lg">
                          <p className="text-[10px] text-gray-400 font-bold mb-0.5">{t.flavor}</p>
                          <p className="text-xs text-gray-700 leading-snug">{data.seasoning}</p>
                      </div>
                      
                      {/* Updated: Steps are always visible */}
                      {data.steps && (
                          <div className="mt-2 pt-2 border-t border-gray-100">
                             <p className="text-[10px] text-gray-400 font-bold mb-1 flex items-center gap-1">
                                {t.steps}
                             </p>
                             <p className="text-[10px] text-gray-600 bg-gray-50 p-2 rounded-lg leading-relaxed whitespace-pre-wrap">
                                 {data.steps}
                             </p>
                          </div>
                      )}
                  </div>
              </div>
            );
          };

          const MiniCounter = ({ icon, label, value, setter }) => (
              <div className="flex items-center justify-between py-2 border-b border-gray-50 last:border-0">
                  <div className="flex items-center gap-2 text-gray-600">
                      {icon}
                      <span className="text-xs font-bold">{label}</span>
                  </div>
                  <div className="flex items-center gap-2">
                      <button 
                        onClick={() => setter(Math.max(0, value - 1))}
                        className="w-6 h-6 rounded-md bg-gray-100 flex items-center justify-center hover:bg-gray-200 text-gray-500"
                      >
                          <Icons.ChevronDown size={14} />
                      </button>
                      <span className="w-4 text-center text-sm font-bold text-gray-800">{value}</span>
                      <button 
                        onClick={() => setter(value + 1)}
                        className="w-6 h-6 rounded-md bg-orange-100 flex items-center justify-center hover:bg-orange-200 text-orange-600"
                      >
                          <Icons.ChevronUp size={14} />
                      </button>
                  </div>
              </div>
          );

          // --- Render ---
          return (
            <div className="min-h-screen bg-[#F8F9FA] font-sans text-gray-900 pb-28">
              {/* Header */}
              <header className="sticky top-0 z-30 bg-white/90 backdrop-blur-md border-b border-gray-200 px-5 py-3 flex justify-between items-start gap-3 shadow-sm">
                <div className="flex items-start gap-3 flex-1">
                  <div className="bg-gradient-to-tr from-orange-500 to-red-500 p-2 rounded-xl shadow-lg shadow-orange-200 mt-1">
                    <Icons.ChefHat className="text-white" size={20} />
                  </div>
                  <div className="flex flex-col">
                      <h1 className="text-lg font-extrabold text-gray-800 leading-tight">{t.title}</h1>
                      <a 
                        href="https://www.threads.net/@replace_with_your_id" 
                        target="_blank" 
                        rel="noreferrer"
                        className="text-[10px] text-gray-500 flex items-center gap-1 hover:text-blue-500 transition-colors mt-0.5"
                      >
                        <Icons.AtSign size={10} /> {t.threadsLinkText} <Icons.ExternalLink size={8} />
                      </a>
                  </div>
                </div>
                <div className="flex items-center gap-2 shrink-0">
                    <button onClick={toggleLanguage} className="p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors"><Icons.Globe size={22} /></button>
                    <button onClick={() => setShowSettings(true)} className="p-2 text-gray-400 hover:bg-gray-100 rounded-full"><Icons.Settings size={22} /></button>
                </div>
              </header>

              {/* Settings Modal */}
              {showSettings && (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4 animate-in fade-in">
                  <div className="bg-white rounded-3xl w-full max-w-sm p-6 shadow-2xl">
                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2">{t.settings}</h2>
                    <div className="space-y-4">
                        <div>
                            <label className="block text-sm font-bold text-gray-700 mb-1">{t.startDate}</label>
                            <input type="date" value={startDate} onChange={(e) => setStartDate(e.target.value)} className="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-orange-500"/>
                        </div>
                        <div>
                            <label className="block text-sm font-bold text-gray-700 mb-1">API Key</label>
                            <input type="password" value={apiKey} onChange={(e) => setApiKey(e.target.value)} placeholder={t.apiKeyPlaceholder} className="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 outline-none"/>
                            <p className="text-xs text-gray-400 mt-1">{t.apiKeyNote}</p>
                        </div>
                        <div className="grid grid-cols-2 gap-3 pt-2">
                            <button onClick={() => setShowSettings(false)} className="py-3 bg-gray-100 text-gray-700 rounded-xl font-bold">{t.cancel}</button>
                            <button onClick={() => saveApiKey(apiKey)} className="py-3 bg-gray-900 text-white rounded-xl font-bold">{t.save}</button>
                        </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Main Content */}
              <main className="p-4 max-w-4xl mx-auto space-y-6">
                {error && (
                  <div className="bg-red-50 text-red-600 p-4 rounded-2xl flex items-center gap-3 text-sm font-medium border border-red-100">
                    <Icons.AlertCircle size={18} /> {error}
                  </div>
                )}

                {activeTab === 'input' && (
                  <div className="space-y-6 animate-in slide-in-from-bottom-4 duration-500">
                    <div className="space-y-4">
                        <div className="flex items-center gap-2 px-1">
                            <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-bold">1</span>
                            <h2 className="text-sm font-bold text-gray-500 uppercase">{t.uploadPhotos}</h2>
                        </div>
                        <PhotoUploader title={t.ingredientsReceipt} type="ingredient" images={ingredientImgs} onUpload={handleImageUpload} onRemove={removeImage} />
                        <PhotoUploader title={t.seasoning} type="seasoning" images={seasoningImgs} onUpload={handleImageUpload} onRemove={removeImage} />
                    </div>

                    <div className="space-y-4">
                        <div className="flex items-center gap-2 px-1">
                            <span className="w-6 h-6 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center font-bold">2</span>
                            <h2 className="text-sm font-bold text-gray-500 uppercase">{t.settings}</h2>
                        </div>
                        
                        <div className="flex gap-4">
                            <div className="flex-1 bg-white p-4 rounded-2xl border border-gray-100 shadow-sm flex flex-col items-center justify-center gap-3">
                                <span className="text-xs font-bold text-gray-500 uppercase tracking-wide">{t.daysLabel}</span>
                                <div className="flex items-center gap-4">
                                    <button onClick={() => setDays(Math.max(1, days - 1))} className="w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center hover:bg-gray-200 text-gray-600 transition-colors"><Icons.ChevronDown size={20} /></button>
                                    <span className="text-4xl font-extrabold text-gray-800 w-12 text-center">{days}</span>
                                    <button onClick={() => setDays(days + 1)} className="w-10 h-10 rounded-xl bg-gray-900 text-white flex items-center justify-center hover:bg-gray-800 shadow-md transition-colors"><Icons.ChevronUp size={20} /></button>
                                </div>
                            </div>
                            <div className="flex-1 bg-white p-4 rounded-2xl border border-gray-100 shadow-sm flex flex-col justify-center">
                                <span className="text-[10px] font-bold text-gray-400 uppercase tracking-wide mb-2 block">{t.mealsLabel}</span>
                                <div className="space-y-1">
                                    <MiniCounter icon={<Icons.Sun size={14} className="text-orange-400"/>} label={t.breakfast} value={meals.breakfast} setter={(v) => setMeals({...meals, breakfast: v})} />
                                    <MiniCounter icon={<Icons.Coffee size={14} className="text-yellow-600"/>} label={t.lunch} value={meals.lunch} setter={(v) => setMeals({...meals, lunch: v})} />
                                    <MiniCounter icon={<Icons.Moon size={14} className="text-indigo-400"/>} label={t.dinner} value={meals.dinner} setter={(v) => setMeals({...meals, dinner: v})} />
                                </div>
                            </div>
                        </div>
                        
                        <div className="p-5 bg-white rounded-2xl border border-gray-100 shadow-sm">
                            <span className="text-gray-700 font-bold mb-4 block">{t.cuisineStyle}</span>
                            <div className="flex flex-wrap gap-2">
                                {Object.keys(t.styles).map(key => {
                                    const isSelected = selectedCuisines.includes(key);
                                    return (
                                        <button key={key} onClick={() => toggleCuisine(key)} className={`px-4 py-2 rounded-lg text-xs font-bold transition-all ${isSelected ? 'bg-orange-500 text-white shadow-md ring-2 ring-orange-200' : 'bg-gray-50 text-gray-600 border border-gray-200 hover:bg-gray-100'}`}>
                                            {t.styles[key]} {isSelected && '‚úì'}
                                        </button>
                                    )
                                })}
                            </div>
                        </div>
                    </div>

                    <button onClick={generateRecipes} disabled={loading} className={`w-full py-5 rounded-2xl text-xl font-bold shadow-xl flex items-center justify-center gap-3 transition-all mt-4 ${loading ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-gray-900 text-white hover:scale-[1.01] active:scale-[0.99] shadow-orange-100'}`}>
                        {loading ? <Icons.Loader2 className="animate-spin" /> : <Icons.Utensils />}
                        {loading ? t.analyzing : t.generate}
                    </button>
                  </div>
                )}

                {activeTab === 'result' && resultData && (
                  <div className="animate-in fade-in duration-500 space-y-8" id="export-container">
                    <div className="flex items-center justify-between">
                        <h2 className="text-2xl font-bold text-gray-800">{t.planTitle}</h2>
                        <div className="flex gap-2" data-html2canvas-ignore>
                            <button onClick={() => setActiveTab('input')} className="px-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-bold text-gray-600 shadow-sm">{t.modify}</button>
                            <button onClick={generateRecipes} className="px-4 py-2 bg-gray-900 text-white rounded-xl text-sm font-bold shadow-md">{t.regenerate}</button>
                        </div>
                    </div>
                    
                    <div className="space-y-6">
                        {resultData.schedule.map((dayPlan, index) => (
                            <div key={index} className="space-y-2 page-break">
                                <div className="flex items-center gap-2 px-1 pt-4">
                                    <span className="bg-orange-100 text-orange-700 px-3 py-1 rounded-lg text-sm font-bold shadow-sm">{getFormatDate(startDate, index, lang)}</span>
                                    <div className="h-px bg-gray-200 flex-1"></div>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                                    <MealCard mealType="breakfast" data={dayPlan.meals.breakfast} />
                                    <MealCard mealType="lunch" data={dayPlan.meals.lunch} />
                                    <MealCard mealType="dinner" data={dayPlan.meals.dinner} />
                                </div>
                            </div>
                        ))}
                    </div>

                    <div className="bg-white rounded-3xl p-6 border border-gray-200 shadow-sm mt-8 page-break">
                        <div className="flex items-center gap-2 mb-6 border-b border-gray-100 pb-4">
                            <Icons.List className="text-gray-400"/>
                            <h3 className="text-lg font-bold text-gray-800">{t.summaryTitle}</h3>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <h4 className="text-sm font-bold text-gray-500 uppercase mb-3 flex items-center gap-2"><div className="w-2 h-2 rounded-full bg-orange-500"></div> {t.needIngredients}</h4>
                                <div className="bg-orange-50/50 rounded-xl p-4">
                                    <ul className="space-y-2">{resultData.summary.ingredients_list.map((item, idx) => (<li key={idx} className="text-sm text-gray-700 flex items-start gap-2"><span className="text-orange-400 mt-1">‚Ä¢</span> {item}</li>))}</ul>
                                </div>
                            </div>
                            <div>
                                <h4 className="text-sm font-bold text-gray-500 uppercase mb-3 flex items-center gap-2"><div className="w-2 h-2 rounded-full bg-green-500"></div> {t.needSeasonings}</h4>
                                <div className="bg-green-50/50 rounded-xl p-4">
                                     <ul className="space-y-2">{resultData.summary.seasonings_list.map((item, idx) => (<li key={idx} className="text-sm text-gray-700 flex items-start gap-2"><span className="text-green-400 mt-1">‚Ä¢</span> {item}</li>))}</ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* EXPORT BUTTONS ROW */}
                    <div className="py-6 flex flex-col gap-4 border-t border-gray-100 mt-6" data-html2canvas-ignore>
                        <h3 className="text-center text-sm font-bold text-gray-400 uppercase tracking-widest">{t.exportTitle}</h3>
                        <div className="grid grid-cols-3 gap-3">
                            <button onClick={exportPDF} className="flex flex-col items-center justify-center gap-2 p-4 bg-white border border-gray-200 rounded-2xl hover:bg-red-50 hover:border-red-200 hover:text-red-600 transition-all shadow-sm">
                                <Icons.Download size={24} className="text-red-500"/>
                                <span className="text-xs font-bold text-center">{t.exportPDF}</span>
                            </button>
                            
                            <button onClick={() => exportWord(resultData, startDate, lang)} className="flex flex-col items-center justify-center gap-2 p-4 bg-white border border-gray-200 rounded-2xl hover:bg-blue-50 hover:border-blue-200 hover:text-blue-600 transition-all shadow-sm">
                                <Icons.FileText size={24} className="text-blue-500"/>
                                <span className="text-xs font-bold text-center">{t.exportWord}</span>
                            </button>
                            
                            <button onClick={() => exportExcel(resultData, startDate, lang)} className="flex flex-col items-center justify-center gap-2 p-4 bg-white border border-gray-200 rounded-2xl hover:bg-green-50 hover:border-green-200 hover:text-green-600 transition-all shadow-sm">
                                <Icons.FileSpreadsheet size={24} className="text-green-500"/>
                                <span className="text-xs font-bold text-center">{t.exportExcel}</span>
                            </button>
                        </div>
                    </div>

                    <div className="h-10"></div>
                  </div>
                )}
              </main>

              <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-6 py-3 flex justify-around items-center z-40 pb-safe">
                <button onClick={() => setActiveTab('input')} className={`flex flex-col items-center gap-1 transition-colors ${activeTab === 'input' ? 'text-orange-600' : 'text-gray-300'}`}>
                  <Icons.Camera size={24} strokeWidth={activeTab === 'input' ? 2.5 : 2} />
                  <span className="text-[10px] font-bold">{t.uploadPhotos}</span>
                </button>
                <div className="w-px h-8 bg-gray-100"></div>
                <button onClick={() => resultData && setActiveTab('result')} disabled={!resultData} className={`flex flex-col items-center gap-1 transition-colors ${activeTab === 'result' ? 'text-orange-600' : 'text-gray-300'}`}>
                  <Icons.BookOpen size={24} strokeWidth={activeTab === 'result' ? 2.5 : 2} />
                  <span className="text-[10px] font-bold">Grid</span>
                </button>
              </nav>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>